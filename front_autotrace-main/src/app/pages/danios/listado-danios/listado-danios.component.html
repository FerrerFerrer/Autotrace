<!-- Content Header (Page header) -->
<div class="content-wrapper big-image">
	<!-- Content Header (Page header) -->
	<div class="content-header">
		<div class="container-fluid">
			<div class="row mb-2">
				<div class="col-sm-6">
					<h1 class="m-0" style="color: white;">
						Listado de daños
					</h1>
				</div>
				<div class="col-sm-6">
					<ol class="breadcrumb float-sm-right">
						<li class="breadcrumb-item">
							<a href="" style="color: white;">Inicio</a>
						</li>
						<li class="breadcrumb-item active" style="color: white;">
							Listado de daños
						</li>
					</ol>
				</div>
			</div>
		</div>
	</div>

	<section class="content">
		<form [formGroup]="form" (ngSubmit)="filtroListaDanio()" role="form">
			<div class="col-sm-12">
				<div class="card">
					<div class="card-body">
						<div class="row">
							<div class="col-sm-12 col-md-6 col-lg-4 col-xl-4">
								<div class="form-group">
									<label>Marca</label>
									<select class="form-control" formControlName="cliente">
										<option value="">Seleccione una marca</option>
										<option *ngFor="let marca of listaClientes" value="{{marca.idcliente}}">
											{{marca.cliente}}
										</option>
									</select>
								</div>
							</div>


							<div class="col-sm-12 col-md-6 col-lg-4 col-xl-4">
								<div class="form-group">
									<label>Fechas de inicio:</label>
									<input type="date" formControlName="fechaIni" class="form-control float-right" id>
								</div>
							</div>
							<div class="col-sm-12 col-md-6 col-lg-4 col-xl-4">
								<div class="form-group">
									<label>Fecha Fin</label>
									<input type="date" formControlName="fechaFin" class="form-control float-right" id>
								</div>
							</div>


							<div class="col-sm-12 col-md-6 col-lg-4 col-xl-4">
								<div class="form-group">
									<label>Area</label>
									<select class="form-control" formControlName="cveAreaDanio">
										<option value>Seleccione el area</option>
										<option *ngFor="let danio of listaAreaDanio" value="{{danio.cveAreaDanio}}">
											{{danio.descripcion}}
										</option>
									</select>
								</div>
							</div>


							<div class="col-sm-12 col-md-6 col-lg-4 col-xl-4">
								<div class="form-group">
									<label>Tipo</label>
									<select class="form-control" formControlName="cveTipoDanio">
										<option value>Seleccione el tipo</option>
										<option *ngFor="let tipoDanio of listaTipoDanio"
											value="{{tipoDanio.cveTipoDanio}}">
											{{tipoDanio.descripcion}}
										</option>
									</select>
								</div>
							</div>


							<div class="col-sm-12 col-md-6 col-lg-4 col-xl-4">
								<div class="form-group">
									<label>
										Estado de reparacion
									</label>
									<select class="form-control" formControlName="danioEstado">
										<option value>
											Seleccione el estado
										</option>
										<option *ngFor="let estado of listaDanioEstado"
											value="{{estado.idDanioEstado}}">
											{{estado.estado}}
										</option>
									</select>
								</div>
							</div>


							<div class="col-sm-12 col-md-6 col-lg-6 col-xl-6">
								<div class="form-group">
									<label>VINS</label>
									<textarea class="form-control" formControlName="vins" rows="3"
										laceholder="Enter ..."></textarea>
								</div>
							</div>


							<div class="col-sm-12 col-md-6 col-lg-6 col-xl-6">
								<div class="form-group">
									<label>Geocerca</label>
									<select multiple class="form-control" formControlName="geocercaControl">
										<option *ngFor="let geocercas of geocercasList"
											value="{{geocercas.idgeocerca}}">
											{{geocercas.geocerca}}
										</option>
									</select>
								</div>
							</div>


						</div>
					</div>
				</div>
			</div>


			<div class="container">
				<div class="row justify-content-center align-items-center">
					<div class="col-sm-12 col-md-6 col-lg-4 col-lx-3 pb-3">
						<button type="submit" class="btn btn-block bg-light">
							<i class="fa fa-search mr-2"></i>
							Buscar
						</button>
					</div>
				</div>
			</div>
		</form>
	</section>


	<section class="content">
		<div class="container-fluid" *ngIf="mostrarTabla">
			<div class="row">
				<div class="col-sm-12">
					<div class="card">
						<div class="card-header" style="background-color: gainsboro;">
							<h3 class="card-title">Vins</h3>
							<div class="card-header" style="background-color: gainsboro;">
								<h3 class="card-title"></h3>
								<div class="row">
									<button type="button" class="btn btn-outline-dark" (click)="exportarConsulta()">
										<i class="far fa-file-excel"></i>
										Exportar Consulta
									</button>
								</div>
							</div>
						</div>
						<div class="card-body">
							<div class="table-responsive">


								<table [dtOptions]="dtOptions" #tableConsulta datatable
									class="table table-striped table-bordered table-sm row-border hover"
									style="width: 100%;">
									<thead>
										<tr>
											<th class="text-center">Detalles</th>
											<th class="text-center">Vin Code</th>
											<th class="text-center">Marca</th>
											<th class="text-center">Fecha registro daño</th>
											<th class="text-center">Area daño</th>
											<th class="text-center">Area adiccion</th>
											<th class="text-center">Tipo daño</th>
											<th class="text-center">Severidad</th>
											<th class="text-center">Ubicacion</th>
											<th class="text-center">Responsable</th>
											<th class="text-center">Clasificacion</th>
											<th class="text-center">
												Estado de reparación
											</th>
											<th class="text-center">
												Fecha inicio de reparacion
											</th>
											<th class="text-center">Fecha de reparacion</th>
											<th class="text-center">
												Tiempo de reparación
											</th>
											<th class="text-center">Observaciones</th>
											<th class="text-center" style="display:none;">Evidencia de daño</th>
											<th class="text-center" style="display:none;">Evidencia de reparacion</th>


										</tr>
									</thead>
									<tbody>
										<tr *ngFor="let row of listaFiltroTabla ">
											<td class="text-center">
												<button (click)="abrirModalDetallesDanio(row)" type="button"
													class="btn btn-outline-dark">
													<i class="fas fa-eye"></i>
												</button>
											</td>
											<td class="text-center">{{row.vin}}</td>
											<td class="text-center">{{row.cliente}}</td>
											<td class="text-center">{{row.fechaRegistro | date:'yyyy-MM-dd HH:mm:ss'}}
											</td>
											<td class="text-center">{{row.areaDanio}}</td>
											<td class="text-center">No Existe Area adiccion</td>
											<td class="text-center">{{row.tipoDanio}}</td>
											<td class="text-center">{{row.severidadFactorDanio}}</td>
											<td class="text-center">{{row.ubicacionDanio}}</td>
											<td class="text-center">{{row.responsable}}</td>
											<td class="text-center">{{row.clasificacion}}</td>
											<td class="text-center">{{row.estadoReparacion}}</td>
											<td class="text-center">{{row.fechaInicioReparacion | date:'yyyy-MM-dd
												hh:mm:ss'}}</td>
											<td class="text-center">{{row.fechaReparacion | date:'yyyy-MM-dd HH:mm:ss'}}
											</td>
											<td class="text-center">{{row.tiempoReparacion}}</td>
											<td class="text-center">{{row.observaciones}}</td>
											<td class="text-center" style="display:none;"><a
													href="{{row.urlFotografia}}">=HIPERVINCULO("{{row.urlFotografiaDanio}}","Ver imagen")</a>
											</td>
											<td class="text-center" style="display:none;"><a
												href="{{row.urlFotografia}}">=HIPERVINCULO("{{row.urlFotografiaReparado}}","Ver imagen")</a>
										</td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
	<ngx-spinner bdColor = "rgba(0, 0, 0, 0.8)" size = "medium" color = "#fff" type = "ball-spin-clockwise" [fullScreen] = "false"><p style="color: white" ></p></ngx-spinner>
</div>